<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Auditoria Hospitalar · Apresentação Executiva</title>
  <style>
    :root {
      --bg: #0b1220;
      --panel: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --accent: #22c55e;
      --accent2: #38bdf8;
      --warn: #fbbf24;
    }
    * { box-sizing: border-box; }
    body {
      margin:0;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(56,189,248,.14), transparent 60%),
        radial-gradient(1000px 700px at 80% 20%, rgba(34,197,94,.10), transparent 55%),
        radial-gradient(800px 600px at 60% 90%, rgba(251,191,36,.10), transparent 60%),
        var(--bg);
    }
    a { color: inherit; }
    .container { max-width: 1180px; margin: 0 auto; padding: 28px 18px 40px; }
    .header {
      display:flex; align-items:flex-end; justify-content:space-between; gap: 18px;
      padding: 18px 18px 14px; border:1px solid var(--stroke); border-radius: 18px;
      background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
    }
    .brand {
      display:flex; gap: 14px; align-items:center;
    }
    .mark {
      width: 46px; height: 46px; border-radius: 14px;
      display:grid; place-items:center;
      font-weight: 800; letter-spacing:.02em;
      background: linear-gradient(135deg, rgba(56,189,248,.22), rgba(34,197,94,.18));
      border: 1px solid var(--stroke);
    }
    .h1 { margin:0; font-size: 22px; line-height: 1.15; letter-spacing: -0.02em; }
    .sub { margin: 6px 0 0; color: var(--muted); font-size: 13px; }
    .meta { text-align:right; color: var(--muted); font-size: 12px; }
    .badge {
      display:inline-flex; align-items:center; gap: 8px;
      padding: 6px 10px; border-radius: 999px; border: 1px solid var(--stroke);
      background: rgba(255,255,255,.04);
    }
    .grid { display:grid; gap: 14px; }
    .kpis { grid-template-columns: repeat(5, minmax(0, 1fr)); margin-top: 14px; }
    .card {
      padding: 14px 14px 12px;
      border: 1px solid var(--stroke);
      border-radius: 16px;
      background: rgba(255,255,255,.05);
    }
    .k-label { color: var(--muted); font-size: 12px; }
    .k-value { font-size: 22px; font-weight: 800; letter-spacing: -0.02em; margin-top: 6px; }
    .k-foot { color: var(--muted); font-size: 11px; margin-top: 4px; }
    .section { margin-top: 16px; }
    .section-title { font-size: 14px; font-weight: 800; margin: 0 0 8px; }
    .section-sub { margin: 0 0 12px; color: var(--muted); font-size: 12px; }
    .two { grid-template-columns: 1.15fr .85fr; }
    .three { grid-template-columns: 1fr 1fr 1fr; }
    .table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }
    .table th, .table td {
      padding: 8px 8px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      vertical-align: top;
    }
    .table th { text-align:left; color: rgba(255,255,255,.78); font-weight: 600; }
    .table td.num { text-align:right; font-variant-numeric: tabular-nums; }
    .muted { color: var(--muted); }
    .compare {
      display:grid; grid-template-columns: 1fr 1fr; gap: 12px;
    }
    .compare-card {
      border: 1px solid var(--stroke);
      border-radius: 16px;
      background: rgba(255,255,255,.05);
      padding: 14px;
    }
    .compare-title { font-weight: 900; letter-spacing:-.02em; }
    .compare-kpis { display:grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
    .compare-kpis .k { display:block; color: var(--muted); font-size: 11px; }
    .compare-kpis .v { display:block; font-weight: 800; margin-top: 2px; font-variant-numeric: tabular-nums; }
    .callout {
      border: 1px solid rgba(251,191,36,.35);
      background: rgba(251,191,36,.08);
      border-radius: 16px;
      padding: 12px 14px;
      color: rgba(255,255,255,.9);
      font-size: 12px;
    }
    .footer { margin-top: 18px; color: var(--muted); font-size: 11px; text-align:center; }
    .bar-container { display: flex; align-items: center; gap: 6px; }
    .bar {
      height: 6px; background: var(--accent2); border-radius: 4px;
    }
    @media (max-width: 1100px) {
      .kpis { grid-template-columns: repeat(2, minmax(0,1fr)); }
      .two { grid-template-columns: 1fr; }
      .three { grid-template-columns: 1fr; }
      .compare { grid-template-columns: 1fr; }
      .meta { text-align:left; }
      .header { align-items:flex-start; flex-direction:column; }
    }
    @media print {
      body { background: #fff; color: #111; }
      :root { --text:#111; --muted:#444; --stroke:#ddd; }
      .card, .header, .compare-card, .callout { background:#fff; }
    }
  </style>
</head>
<body>
<div class="container">

  <!-- cabeçalho com dados do JSON -->
  <div class="header">
    <div class="brand">
      <div class="mark">AH</div>
      <div>
        <h1 class="h1">Auditoria Hospitalar · Apresentação Executiva</h1>
        <p class="sub">Base: <b>1.017</b> prontuários e <b>4.885</b> erros (SQLite).</p>
      </div>
    </div>
    <div class="meta">
      <div class="badge">Atualizado com dados do seu banco</div>
      <div style="margin-top:8px">Período detectado: <b>2025-10</b> → <b>2026-02</b></div>
    </div>
  </div>

  <!-- KPIs principais (exatos do JSON) -->
  <div class="grid kpis">
    <div class="card">
      <div class="k-label">Prontuários (total)</div>
      <div class="k-value">1.017</div>
      <div class="k-foot">Registros na tabela <code>prontuario</code></div>
    </div>
    <div class="card">
      <div class="k-label">Prontuários com erro</div>
      <div class="k-value">940</div>
      <div class="k-foot">Distinct prontuário com registros em <code>erro</code></div>
    </div>
    <div class="card">
      <div class="k-label">Total de erros</div>
      <div class="k-value">4.885</div>
      <div class="k-foot">Registros na tabela <code>erro</code></div>
    </div>
    <div class="card">
      <div class="k-label">% prontuários com erro</div>
      <div class="k-value">92,43%</div>
      <div class="k-foot">Prontuários com erro ÷ prontuários</div>
    </div>
    <div class="card">
      <div class="k-label">Erros por prontuário</div>
      <div class="k-value">4,80</div>
      <div class="k-foot">Total erros ÷ prontuários</div>
    </div>
  </div>

  <!-- Destaque Dez vs Jan (correto) -->
  <div class="section">
    <h2 class="section-title">Destaque do período</h2>
    <p class="section-sub">Comparativo objetivo de Dezembro/2025 vs Janeiro/2026 (com base em <code>fim_auditoria</code> / <code>recebimento_prontuario</code> / <code>data_criacao</code>).</p>
    <div class="compare">
      <div class="compare-card">
        <div class="compare-title">Dezembro/2025</div>
        <div class="compare-kpis">
          <div><span class="k">Prontuários</span><span class="v">348</span></div>
          <div><span class="k">Erros</span><span class="v">2.125</span></div>
          <div><span class="k">% com erro</span><span class="v">89,94%</span></div>
          <div><span class="k">Erros/pront.</span><span class="v">6,11</span></div>
        </div>
      </div>
      <div class="compare-card">
        <div class="compare-title">Janeiro/2026</div>
        <div class="compare-kpis">
          <div><span class="k">Prontuários</span><span class="v">206</span></div>
          <div><span class="k">Erros</span><span class="v">1.179</span></div>
          <div><span class="k">% com erro</span><span class="v">94,17%</span></div>
          <div><span class="k">Erros/pront.</span><span class="v">5,72</span></div>
        </div>
      </div>
    </div>
    <div class="callout" style="margin-top:12px">
      <b>Leitura rápida:</b> de Dez/2025 para Jan/2026, houve variação de <b>-946</b> erros e redução no volume de erros, com mudança de +4,23 p.p. na taxa de prontuários com erro.
    </div>
  </div>

  <!-- Tendência mensal (tabela) + SLAs -->
  <div class="section grid two">
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Tendência mensal</h3>
      <p class="section-sub">Série histórica (prontuários, prontuários com erro e total de erros).</p>
      <div style="overflow-x: auto;">
        <table class="table">
          <thead>
            <tr><th>Mês</th><th class="num">Prontuários</th><th class="num">c/ erro</th><th class="num">Erros</th></tr>
          </thead>
          <tbody>
            <tr><td>2025-10</td><td class="num">87</td><td class="num">87</td><td class="num">438</td></tr>
            <tr><td>2025-11</td><td class="num">182</td><td class="num">153</td><td class="num">643</td></tr>
            <tr><td>2025-12</td><td class="num">348</td><td class="num">313</td><td class="num">2.125</td></tr>
            <tr><td>2026-01</td><td class="num">206</td><td class="num">194</td><td class="num">1.179</td></tr>
            <tr><td>2026-02</td><td class="num">16</td><td class="num">15</td><td class="num">72</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card">
      <h3 class="section-title" style="margin-top:0">SLAs e tempos (dados válidos)</h3>
      <p class="section-sub">Intervalos não‑negativos, outliers removidos.</p>
      <div style="overflow:auto">
        <table class="table">
          <thead><tr><th>Métrica</th><th class="num">Mediana</th><th class="num">Média</th><th class="num">P90</th><th class="muted">Amostra</th></tr></thead>
          <tbody>
            <tr><td>Tempo de permanência (alta − admissão)</td><td class="num">1,0</td><td class="num">1,3</td><td class="num">1,0</td><td class="muted">n=835</td></tr>
            <tr><td>Recebimento → Fim auditoria</td><td class="num">1,0</td><td class="num">2,1</td><td class="num">4,0</td><td class="muted">n=832</td></tr>
            <tr><td>Fim auditoria → Envio faturamento</td><td class="num">0,0</td><td class="num">0,0</td><td class="num">0,0</td><td class="muted">n=821</td></tr>
            <tr><td>Alta → Envio faturamento</td><td class="num">8,0</td><td class="num">9,6</td><td class="num">16,0</td><td class="muted">n=827</td></tr>
          </tbody>
        </table>
      </div>
      <p class="muted" style="margin:10px 0 0; font-size:11px">
        Obs.: SLAs “estranhos” (negativo/muito alto) costumam vir de datas invertidas ou vazias.
      </p>
    </div>
  </div>

  <!-- Top setor / convênio / tipo (substituem as imagens) -->
  <div class="section grid three">
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Erros por setor</h3>
      <p class="section-sub">Top (dados disponíveis)</p>
      <table class="table">
        <thead><tr><th>Setor</th><th class="num">Erros</th></tr></thead>
        <tbody>
          <tr><td>INTERNAÇÃO / CC</td><td class="num">4.547</td></tr>
          <tr><td>INTERNAÇÃO / CLINICA</td><td class="num">338</td></tr>
        </tbody>
      </table>
    </div>
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Erros por convênio</h3>
      <p class="section-sub">Top 10</p>
      <div style="overflow:auto; max-height:200px">
        <table class="table">
          <thead><tr><th>Convênio</th><th class="num">Erros</th></tr></thead>
          <tbody>
            <tr><td>UNIMED</td><td class="num">3.776</td></tr>
            <tr><td>UNIMED / INTERCÂMBIO</td><td class="num">517</td></tr>
            <tr><td>MAIS SAUDE</td><td class="num">365</td></tr>
            <tr><td>SUL AMERICA</td><td class="num">95</td></tr>
            <tr><td>CASSI</td><td class="num">46</td></tr>
            <tr><td>BRADESCO</td><td class="num">23</td></tr>
            <tr><td>VIVACOM</td><td class="num">21</td></tr>
            <tr><td>AFFEGO</td><td class="num">16</td></tr>
            <tr><td>UNIMED/ INTERCAMBIO</td><td class="num">8</td></tr>
            <tr><td>FUSEX</td><td class="num">6</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Tipos de erro</h3>
      <p class="section-sub">Top</p>
      <table class="table">
        <thead><tr><th>Tipo</th><th class="num">Erros</th></tr></thead>
        <tbody>
          <tr><td>ERRO FATURAMENTO</td><td class="num">3.627</td></tr>
          <tr><td>ERRO ENFERMAGEM</td><td class="num">934</td></tr>
          <tr><td>ERRO MÉDICO</td><td class="num">199</td></tr>
          <tr><td>ERRO RECEPÇÃO</td><td class="num">124</td></tr>
          <tr><td>ERRO ENVOLVENDO EQUIPE MULTIDICIPLINAR</td><td class="num">1</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Pareto de causas (agora tabela com percentuais corretos) + lista detalhada -->
  <div class="section grid two">
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Pareto de causas</h3>
      <p class="section-sub">Top 15 causas e acumulado (base: total de erros = 4.885)</p>
      <div style="overflow:auto; max-height:360px">
        <table class="table">
          <thead>
            <tr><th>Causa</th><th class="num">Erros</th><th class="num">%</th><th class="num">% acum.</th></tr>
          </thead>
          <tbody>
            <!-- dados extraídos do JSON, com percentuais calculados sobre 4885 -->
            <tr><td>MATERIAL NÃO COBRADO</td><td class="num">1.380</td><td class="num">28,25%</td><td class="num">28,25%</td></tr>
            <tr><td>MEDICAÇÃO NÃO COBRADA</td><td class="num">1.099</td><td class="num">22,50%</td><td class="num">50,75%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATORIOS CENTRO CIRURGICO</td><td class="num">596</td><td class="num">12,20%</td><td class="num">62,95%</td></tr>
            <tr><td>COBRANÇA INDEVIDA</td><td class="num">482</td><td class="num">9,87%</td><td class="num">72,82%</td></tr>
            <tr><td>NÃO COBRADO TX ALIMENTAÇÃO</td><td class="num">183</td><td class="num">3,75%</td><td class="num">76,57%</td></tr>
            <tr><td>FALTA IMPRESSÃO EVOLUÇÃO MÉDICA</td><td class="num">146</td><td class="num">2,99%</td><td class="num">79,56%</td></tr>
            <tr><td>COBRANÇA INDEVIDA (2)</td><td class="num">86</td><td class="num">1,76%</td><td class="num">81,32%</td></tr>
            <tr><td>FALTA COBRAR FIO CIRURGICO</td><td class="num">86</td><td class="num">1,76%</td><td class="num">83,08%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATÓRIO DE ENFERMAGEM</td><td class="num">83</td><td class="num">1,70%</td><td class="num">84,78%</td></tr>
            <tr><td>GUIA SEM ASSINATURA</td><td class="num">72</td><td class="num">1,47%</td><td class="num">86,25%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATORIO DE ENFERMAGEM</td><td class="num">63</td><td class="num">1,29%</td><td class="num">87,54%</td></tr>
            <tr><td>FALTA IMPRESSÃO EVOLUÇÃO MEDICA</td><td class="num">51</td><td class="num">1,04%</td><td class="num">88,58%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATÓRIO DE ENFERMAGEM POSTO</td><td class="num">49</td><td class="num">1,00%</td><td class="num">89,58%</td></tr>
            <tr><td>FALTA BOLAR OU CHECAR MEDICAÇÃO</td><td class="num">43</td><td class="num">0,88%</td><td class="num">90,46%</td></tr>
            <tr><td>TX ALIMENTAÇÃO</td><td class="num">42</td><td class="num">0,86%</td><td class="num">91,32%</td></tr>
          </tbody>
        </table>
      </div>
      <p class="muted" style="margin-top:8px">* acumulado considera as causas listadas; as demais somam 8,68%.</p>
    </div>
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Top causas (tabela completa)</h3>
      <p class="section-sub">Base: tabela <code>erro</code> agrupada por <code>causa</code>.</p>
      <div style="overflow:auto; max-height:360px">
        <table class="table">
          <thead><tr><th>Causa</th><th class="num">Erros</th><th class="num">% (total 4.885)</th></tr></thead>
          <tbody>
            <tr><td>MATERIAL NÃO COBRADO</td><td class="num">1.380</td><td class="num">28,25%</td></tr>
            <tr><td>MEDICAÇÃO NÃO COBRADA</td><td class="num">1.099</td><td class="num">22,50%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATORIOS CENTRO CIRURGICO</td><td class="num">596</td><td class="num">12,20%</td></tr>
            <tr><td>COBRANÇA INDEVIDA </td><td class="num">482</td><td class="num">9,87%</td></tr>
            <tr><td>NÃO COBRADO TX ALIMENTAÇÃO</td><td class="num">183</td><td class="num">3,75%</td></tr>
            <tr><td>FALTA IMPRESSÃO EVOLUÇÃO MÉDICA </td><td class="num">146</td><td class="num">2,99%</td></tr>
            <tr><td>COBRANÇA INDEVIDA</td><td class="num">86</td><td class="num">1,76%</td></tr>
            <tr><td>FALTA COBRAR FIO CIRURGICO</td><td class="num">86</td><td class="num">1,76%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATÓRIO DE ENFERMAGEM</td><td class="num">83</td><td class="num">1,70%</td></tr>
            <tr><td>GUIA SEM ASSINATURA</td><td class="num">72</td><td class="num">1,47%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATORIO DE ENFERMAGEM</td><td class="num">63</td><td class="num">1,29%</td></tr>
            <tr><td>FALTA IMPRESSÃO EVOLUÇÃO MEDICA</td><td class="num">51</td><td class="num">1,04%</td></tr>
            <tr><td>FALTA IMPRESSÃO RELATÓRIO DE ENFERMAGEM POSTO</td><td class="num">49</td><td class="num">1,00%</td></tr>
            <tr><td>FALTA BOLAR OU CHECAR MEDICAÇÃO </td><td class="num">43</td><td class="num">0,88%</td></tr>
            <tr><td>TX ALIMENTAÇÃO</td><td class="num">42</td><td class="num">0,86%</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Responsáveis e próximos passos -->
  <div class="section grid two">
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Responsáveis (quando informado)</h3>
      <p class="section-sub">Top 10 responsáveis vinculados no registro do erro.</p>
      <div style="overflow:auto">
        <table class="table">
          <thead><tr><th>Responsável</th><th class="num">Erros</th></tr></thead>
          <tbody>
            <tr><td>BRUNO TAVARES</td><td class="num">2.324</td></tr>
            <tr><td>KATIA ALVES</td><td class="num">1.064</td></tr>
            <tr><td>SABRYNA GABRIELLA</td><td class="num">803</td></tr>
            <tr><td>LEDISMAR</td><td class="num">164</td></tr>
            <tr><td>WARLEY</td><td class="num">139</td></tr>
            <tr><td>LORENA</td><td class="num">88</td></tr>
            <tr><td>KALITA OLIVEIRA LISBOA</td><td class="num">12</td></tr>
            <tr><td>ANA KAROLINA</td><td class="num">8</td></tr>
            <tr><td>RENATO MARINHO</td><td class="num">4</td></tr>
            <tr><td>JUNICHIRO</td><td class="num">3</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Próximos passos sugeridos</h3>
      <p class="section-sub">Com base no seu banco, dá para evoluir para governança e redução de retrabalho.</p>
      <ol style="margin:0; padding-left: 18px; color: rgba(255,255,255,.86); font-size: 12px; line-height:1.55">
        <li><b>Padronizar datas</b> (recebimento, fim auditoria, faturamento) e bloquear inversões.</li>
        <li><b>Completar dicionários</b>: <code>categoria_erro</code> está vazio — preencher e vincular no <code>erro.categoria_erro_id</code>.</li>
        <li><b>Plano 80/20</b>: atacar as 3–5 causas líderes (Pareto) com ações e re-auditoria mensal.</li>
        <li><b>Metas</b>: reduzir “erros por prontuário” e “% prontuários com erro” por setor/convênio.</li>
        <li><b>Rotina executiva</b>: gerar esta apresentação mensal automaticamente (HTML/PDF).</li>
      </ol>
    </div>
  </div>

  <div class="footer">
    Arquivo estático (HTML) · Gerado a partir do seu <code>auditoria.db</code> · Todos os dados inline, sem imagens externas.
  </div>

</div>
</body>
</html>